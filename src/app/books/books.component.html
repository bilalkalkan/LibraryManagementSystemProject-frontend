<div class="container">
  <div class="row">
    <form [formGroup]="form">
      <div class="col-md-4">
        <label for="name">Kitap İsmi</label>
        <input
          type="text"
          name="name"
          id="name"
          autocomplete="off"
          class="form-control"
          required
          formControlName="name"
          [ngClass]="{
            'is-invalid': f['name'].invalid && f['name'].dirty,
            'is-valid': f['name'].valid
          }"
        />
        <ng-container
          [ngTemplateOutlet]="formAlertTemplate"
          [ngTemplateOutletContext]="{
            validation: 'required',
            message: 'Bu alan boş bırakılamaz',
            control: f['name']
          }"
        ></ng-container>
        <ng-container
          [ngTemplateOutlet]="formAlertTemplate"
          [ngTemplateOutletContext]="{
            validation: 'minlength',
            message: 'En az üç karakter',
            control: f['name']
          }"
        ></ng-container>
        <ng-container
          [ngTemplateOutlet]="formAlertTemplate"
          [ngTemplateOutletContext]="{
            validation: 'maxlength',
            message: 'En fazla otuz karakter',
            control: f['name']
          }"
        ></ng-container>
      </div>
      <div class="col-md-4">
        <label for="authorName">Yazar İsmi</label>
        <input
          type="text"
          name="authorName"
          id="authorName"
          autocomplete="off"
          class="form-control"
          formControlName="authorName"
          [ngClass]="{
            'is-invalid': f['authorName'].invalid && f['authorName'].dirty,
            'is-valid': f['authorName'].valid
          }"
        />
        <ng-container
          [ngTemplateOutlet]="formAlertTemplate"
          [ngTemplateOutletContext]="{
            validation: 'required',
            message: 'Bu alan boş bırakılamaz',
            control: f['authorName']
          }"
        ></ng-container>

        <ng-container
          [ngTemplateOutlet]="formAlertTemplate"
          [ngTemplateOutletContext]="{
            validation: 'minlength',
            message: 'En az üç karakter',
            control: f['authorName']
          }"
        ></ng-container>
        <ng-container
          [ngTemplateOutlet]="formAlertTemplate"
          [ngTemplateOutletContext]="{
            validation: 'maxlength',
            message: 'En fazla otuz karakter',
            control: f['authorName']
          }"
        ></ng-container>
      </div>
      <div class="col-md-4">
        <label for="publisherName">Yayınevi</label>
        <input
          type="text"
          name="publisherName"
          id="publisherName"
          autocomplete="off"
          class="form-control"
          formControlName="publisherName"
          [ngClass]="{
            'is-invalid':
              f['publisherName'].invalid && f['publisherName'].dirty,
            'is-valid': f['publisherName'].valid
          }"
        />
        <ng-container
          [ngTemplateOutlet]="formAlertTemplate"
          [ngTemplateOutletContext]="{
            validation: 'required',
            message: 'Bu alan boş bırakılamaz',
            control: f['publisherName']
          }"
        ></ng-container>
        <ng-container
          [ngTemplateOutlet]="formAlertTemplate"
          [ngTemplateOutletContext]="{
            validation: 'minlength',
            message: 'En az üç karakter',
            control: f['publisherName']
          }"
        ></ng-container>
        <ng-container
          [ngTemplateOutlet]="formAlertTemplate"
          [ngTemplateOutletContext]="{
            validation: 'maxlength',
            message: 'En fazla otuz karakter',
            control: f['publisherName']
          }"
        ></ng-container>
      </div>
      <div class="col-md-4">
        <label for="dateOfIssue">Basım Yılı</label>
        <input
          type="text"
          name="dateOfIssue"
          id="dateOfIssue"
          autocomplete="off"
          class="form-control"
          formControlName="dateOfIssue"
          [ngClass]="{
            'is-invalid': f['dateOfIssue'].invalid && f['dateOfIssue'].dirty,
            'is-valid': f['dateOfIssue'].valid
          }"
        />
        <ng-container
          [ngTemplateOutlet]="formAlertTemplate"
          [ngTemplateOutletContext]="{
            validation: 'required',
            message: 'Bu alan boş bırakılamaz',
            control: f['dateOfIssue']
          }"
        ></ng-container>
        <ng-container
          [ngTemplateOutlet]="formAlertTemplate"
          [ngTemplateOutletContext]="{
            validation: 'minlength',
            message: 'En az 4 karakter',
            control: f['dateOfIssue']
          }"
        ></ng-container>
        <ng-container
          [ngTemplateOutlet]="formAlertTemplate"
          [ngTemplateOutletContext]="{
            validation: 'maxlength',
            message: 'En fazla 4 karakter',
            control: f['dateOfIssue']
          }"
        ></ng-container>
      </div>
      <label for="bookStatus">Kitap Emanette mi?</label>
      <div class="form-check">
        <input
          class="form-check-input"
          type="radio"
          name="bookStatus"
          id="bookStatus1"
          formControlName="bookStatus"
          [ngClass]="{
            'is-invalid': f['bookStatus'].invalid && f['bookStatus'].dirty,
            'is-valid': f['bookStatus'].valid && f['bookStatus'].dirty
          }"
          [value]="false"
        />
        <ng-container
          [ngTemplateOutlet]="formAlertTemplate"
          [ngTemplateOutletContext]="{
            validation: 'required',
            message: 'Bu alan boş bırakılamaz',
            control: f['bookStatus']
          }"
        ></ng-container>
        <label class="form-check-label" for="bookStatus1"> Evet </label>
      </div>
      <div class="form-check">
        <input
          class="form-check-input"
          type="radio"
          name="bookStatus"
          id="bookStatus2"
          formControlName="bookStatus"
          [ngClass]="{
            'is-invalid': f['bookStatus'].invalid && f['bookStatus'].dirty,
            'is-valid': f['bookStatus'].valid && f['bookStatus'].dirty
          }"
          [value]="true"
        />
        <ng-container
          [ngTemplateOutlet]="formAlertTemplate"
          [ngTemplateOutletContext]="{
            validation: 'required',
            message: 'Bu alan boş bırakılamaz',
            control: f['bookStatus']
          }"
        ></ng-container>
        <label class="form-check-label" for="bookStatus2"> Hayır </label>
      </div>
      <br />
      <div class="d-grid gap-2 d-md-block">
        <button class="btn btn-success" type="button" (click)="save()">
          Kaydet
        </button>
        <button class="btn btn-warning" type="button" (click)="clear()">
          Temizle
        </button>
      </div>
    </form>

    <table class="table">
      <thead>
        <tr>
          <th>Kitap İsmi</th>
          <th>Yazar İsmi</th>
          <th>Yayınevi</th>
          <th>Basım Yılı</th>
          <th>Kitap Durumu</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let book of books">
          <td>{{ book.name | titlecase }}</td>
          <td>{{ book.authorName | titlecase }}</td>
          <td>{{ book.publisherName | titlecase }}</td>
          <td>{{ book.dateOfIssue }}</td>
          <td *ngIf="book.bookStatus == true">{{ bookTrue }}</td>
          <td *ngIf="book.bookStatus == false">{{ bookFalse }}</td>
          <td>
            <div
              class="btn-group"
              role="group"
              aria-label="Basic mixed styles example"
            >
              <button
                type="button"
                class="btn btn-danger"
                (click)="deleteBook(book)"
              >
                Sil
              </button>
              <button
                type="button"
                class="btn btn-info"
                (click)="getById(book.id)"
              >
                Güncelle
              </button>
            </div>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</div>

<ng-template
  #formAlertTemplate
  let-control="control"
  let-message="message"
  let-validation="validation"
>
  <ng-container
    *ngIf="control.hasError(validation) && (control.dirty || control.touched)"
  >
    <div class="text-danger">{{ message }}</div>
  </ng-container>
</ng-template>
